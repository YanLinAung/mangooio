<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.1) on Mon Dec 03 15:36:44 GMT 2018 -->
<title>TOTPValidator (mangooio-core 5.0.2-SNAPSHOT API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2018-12-03">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="TOTPValidator (mangooio-core 5.0.2-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":9,"i1":10,"i2":10,"i3":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/TOTPValidator.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
</ul>
<div class="aboutLanguage">svenkubiak, 5.0.2-SNAPSHOT</div>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">io.mangoo.crypto.totp</a></div>
<h2 title="Class TOTPValidator" class="title">Class TOTPValidator</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>io.mangoo.crypto.totp.TOTPValidator</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre>public final class <span class="typeNameLabel">TOTPValidator</span>
extends java.lang.Object</pre>
<div class="block">A Time-based One-time Password (TOTP) validator.
 
 <p>
 As per <a href="https://tools.ietf.org/html/rfc6238#section-5.2">RFC 6238 (section 5.2)</a>:
 </p>
 <p>
 "An OTP generated within the same time step will be the same. When an OTP is
 received at a validation system, it doesn't know a client's exact timestamp
 when an OTP was generated. The validation system may typically use the
 timestamp when an OTP is received for OTP comparison. Due to network latency,
 the gap (as measured by T, that is, the number of time steps since T0)
 between the time that the OTP was generated and the time that the OTP arrives
 at the receiving system may be large. The receiving time at the validation
 system and the actual OTP generation may not fall within the same time-step
 window that produced the same OTP. When an OTP is generated at the end of a
 time-step window, the receiving time most likely falls into the next
 time-step window. A validation system SHOULD typically set a policy for an
 acceptable OTP transmission delay window for validation. The validation
 system should compare OTPs not only with the receiving timestamp but also the
 past timestamps that are within the transmission delay. A larger acceptable
 delay window would expose a larger window for attacks. We RECOMMEND that at
 most one time step is allowed as the network delay."
 </p>
 
 <p>
 Example:
 </p>
 
 <pre>
 // We will let the TOTP generation time == TOTP validation time so validation will succeed.
 final long time = System.currentTimeMillis(); 
 byte[] key = &quot;...&quot;;
 TOTP totp = TOTP.key(key).build(time);
 boolean valid = TOTPValidator.window(0).isValid(key, totp.timeStep(), totp.digits(), totp.hmacShaAlgorithm(), totp.value(), time);
 // Should print &quot;TOTP = ..., valid = true&quot;
 System.out.printf(&quot;TOTP = %s, valid = %s%n&quot;, totp.value(), valid);
 </pre></div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Johnny Mongiat</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="https://tools.ietf.org/html/rfc6238#section-5.2">RFC 6238 (section 5.2)</a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DEFAULT_WINDOW">DEFAULT_WINDOW</a></span></code></th>
<td class="colLast">
<div class="block">The default window verification size.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static <a href="TOTPValidator.html" title="class in io.mangoo.crypto.totp">TOTPValidator</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#defaultWindow()">defaultWindow</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns a new <a href="TOTPValidator.html" title="class in io.mangoo.crypto.totp"><code>TOTPValidator</code></a> instance initialized with the
 <a href="#DEFAULT_WINDOW"><code>DEFAULT_WINDOW</code></a> verification size.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isValid(byte%5B%5D,long,int,io.mangoo.enums.HmacShaAlgorithm,java.lang.String)">isValid</a></span>&#8203;(byte[]&nbsp;key,
       long&nbsp;timeStep,
       int&nbsp;digits,
       <a href="../../enums/HmacShaAlgorithm.html" title="enum in io.mangoo.enums">HmacShaAlgorithm</a>&nbsp;hmacShaAlgorithm,
       java.lang.String&nbsp;value)</code></th>
<td class="colLast">
<div class="block">Returns <code>true</code> if the specified TOTP <code>value</code> matches the
 value of the TOTP generated at validation, otherwise <code>false</code>.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isValid(byte%5B%5D,long,int,io.mangoo.enums.HmacShaAlgorithm,java.lang.String,long)">isValid</a></span>&#8203;(byte[]&nbsp;key,
       long&nbsp;timeStep,
       int&nbsp;digits,
       <a href="../../enums/HmacShaAlgorithm.html" title="enum in io.mangoo.enums">HmacShaAlgorithm</a>&nbsp;hmacShaAlgorithm,
       java.lang.String&nbsp;value,
       long&nbsp;validationTime)</code></th>
<td class="colLast">
<div class="block">Returns <code>true</code> if the specified TOTP <code>value</code> matches the
 value of the TOTP generated at validation, otherwise <code>false</code>.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static <a href="TOTPValidator.html" title="class in io.mangoo.crypto.totp">TOTPValidator</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#window(int)">window</a></span>&#8203;(int&nbsp;window)</code></th>
<td class="colLast">
<div class="block">Returns a new <a href="TOTPValidator.html" title="class in io.mangoo.crypto.totp"><code>TOTPValidator</code></a> instance initialized with the
 specified <code>window</code> verification size.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="DEFAULT_WINDOW">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DEFAULT_WINDOW</h4>
<pre>public static final&nbsp;int DEFAULT_WINDOW</pre>
<div class="block">The default window verification size.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#io.mangoo.crypto.totp.TOTPValidator.DEFAULT_WINDOW">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="defaultWindow()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>defaultWindow</h4>
<pre class="methodSignature">public static&nbsp;<a href="TOTPValidator.html" title="class in io.mangoo.crypto.totp">TOTPValidator</a>&nbsp;defaultWindow()</pre>
<div class="block">Returns a new <a href="TOTPValidator.html" title="class in io.mangoo.crypto.totp"><code>TOTPValidator</code></a> instance initialized with the
 <a href="#DEFAULT_WINDOW"><code>DEFAULT_WINDOW</code></a> verification size.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a new <a href="TOTPValidator.html" title="class in io.mangoo.crypto.totp"><code>TOTPValidator</code></a> instance.</dd>
</dl>
</li>
</ul>
<a id="window(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>window</h4>
<pre class="methodSignature">public static&nbsp;<a href="TOTPValidator.html" title="class in io.mangoo.crypto.totp">TOTPValidator</a>&nbsp;window&#8203;(int&nbsp;window)</pre>
<div class="block">Returns a new <a href="TOTPValidator.html" title="class in io.mangoo.crypto.totp"><code>TOTPValidator</code></a> instance initialized with the
 specified <code>window</code> verification size.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>window</code> - the window verification size</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a new <a href="TOTPValidator.html" title="class in io.mangoo.crypto.totp"><code>TOTPValidator</code></a> instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>window</code> is &lt; 0.</dd>
</dl>
</li>
</ul>
<a id="isValid(byte[],long,int,io.mangoo.enums.HmacShaAlgorithm,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isValid</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;isValid&#8203;(byte[]&nbsp;key,
                       long&nbsp;timeStep,
                       int&nbsp;digits,
                       <a href="../../enums/HmacShaAlgorithm.html" title="enum in io.mangoo.enums">HmacShaAlgorithm</a>&nbsp;hmacShaAlgorithm,
                       java.lang.String&nbsp;value)</pre>
<div class="block">Returns <code>true</code> if the specified TOTP <code>value</code> matches the
 value of the TOTP generated at validation, otherwise <code>false</code>. The
 current system time (current time in milliseconds since the UNIX epoch)
 is used as the validation reference time.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - the encoded shared secret key</dd>
<dd><code>timeStep</code> - the time step size in milliseconds</dd>
<dd><code>digits</code> - the number of digits a TOTP should contain</dd>
<dd><code>hmacShaAlgorithm</code> - <a href="../../enums/HmacShaAlgorithm.html" title="enum in io.mangoo.enums"><code>HmacShaAlgorithm</code></a></dd>
<dd><code>value</code> - the TOTP value to validate</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if the specified TOTP <code>code</code> value matches the
         code value of the TOTP generated at validation, otherwise
         <code>false</code>.</dd>
</dl>
</li>
</ul>
<a id="isValid(byte[],long,int,io.mangoo.enums.HmacShaAlgorithm,java.lang.String,long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>isValid</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;isValid&#8203;(byte[]&nbsp;key,
                       long&nbsp;timeStep,
                       int&nbsp;digits,
                       <a href="../../enums/HmacShaAlgorithm.html" title="enum in io.mangoo.enums">HmacShaAlgorithm</a>&nbsp;hmacShaAlgorithm,
                       java.lang.String&nbsp;value,
                       long&nbsp;validationTime)</pre>
<div class="block">Returns <code>true</code> if the specified TOTP <code>value</code> matches the
 value of the TOTP generated at validation, otherwise <code>false</code>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - the encoded shared secret key</dd>
<dd><code>timeStep</code> - the time step size in milliseconds</dd>
<dd><code>digits</code> - the number of digits a TOTP should contain</dd>
<dd><code>hmacShaAlgorithm</code> - <a href="../../enums/HmacShaAlgorithm.html" title="enum in io.mangoo.enums"><code>HmacShaAlgorithm</code></a></dd>
<dd><code>value</code> - the TOTP value to validate</dd>
<dd><code>validationTime</code> - the validation reference time in milliseconds</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if the specified TOTP <code>code</code> value matches the
         code value of the TOTP generated at validation, otherwise
         <code>false</code>.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/TOTPValidator.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
</ul>
<div class="aboutLanguage">svenkubiak, 5.0.2-SNAPSHOT</div>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2015&#x2013;2018. All rights reserved.</small></p>
</footer>
</body>
</html>
